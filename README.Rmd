---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

# covid-19

<!-- badges: start -->
<!-- badges: end -->

This is another analysis of the outbreak of [Coronavirus / Covid-19 disease](https://en.wikipedia.org/wiki/Coronavirus_disease_2019).

Many others have done excellent analysis, and my attempts are specifically trying to add flavour to the statistics in South Africa.

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = FALSE
)
```


```{r, warning=FALSE}
suppressPackageStartupMessages({
  library(tidyverse)
  library(ggplot2)
  library(ggrepel)
})

source("R/get_data.R")
source("R/prep_data.R")
source("R/plot_covid.R")
```




## Data source

The data source is [a repository maintained by Johns Hopkins University](https://github.com/CSSEGISandData/COVID-19). The data is updated once per day.


## Total cases

```{r}
type <- "cases"
imported_threshold <- if (type == "cases") 30 else 10

dat <- get_covid19_data(type)

if (type == "cases"){
  dat <-
    tribble(
      ~country, ~date, ~long, ~lat, ~n,
      "China", as.Date("2020-01-16"), 112, 32.8, 28,
      "China", as.Date("2020-01-17"), 112, 32.8, 41,
      "China", as.Date("2020-01-20"), 112, 32.8, 260,
      "South Africa", as.Date("2020-03-23"), 22.9, -30.6, 402
    ) %>%
    bind_rows(
      dat
    )
  attr(dat, "type") <- "cases"
}

```

```{r}
dat %>%
  filter(country == "South Africa") %>%
  tail()
```



```{r}
dat %>%
  prep_data_timeseries(threshold = imported_threshold) %>%
  plot(scale = "linear")
```

```{r}
dat %>%
  prep_data_timeseries(threshold = imported_threshold) %>%
  plot(scale = "log10")
```


## Number of deaths

```{r}
type <- "deaths"
imported_threshold <- if (type == "cases") 30 else 10

dat <- get_covid19_data(type)

```

```{r}
dat %>%
  filter(country == "South Africa") %>%
  tail()
```



```{r}
dat %>%
  prep_data_timeseries(threshold = imported_threshold) %>%
  plot(scale = "log10")
```


## Regional distribution of Covid-19 deaths

```{r}
dat %>%
  prep_data_map() %>%
  plot()

```

